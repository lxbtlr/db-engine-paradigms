# small-SWOLE testbench

> now working on raspberry pi!

### notes 

- Replaced Intel-specific AVX-512 headers with [SIMDe](https://github.com/simd-everywhere/simde#) to emulate 512-bit vectors using ARM NEON instructions. 
  - NOTE: `simde` headers are typically not installed by default, using nix-env is an easy way to patch this. In the repo on the machine you want to set this up with use a 
  ```bash
  nix-env -iA nixpkgs.simde
  ```
  and make sure to add `.nix-profile/include` to your cmake `-DCMAKE_CXX_FLAGS`

- gtest wants a value assignment to prove the stack is growing the right direction (modern c++). Updating line 1006 in `googletest-src/googletest/src/gtest-death-test.cc` to `dummy=0` is an easy spot fix

- make sure to copy the `tpch.makefile` to the tpch db-gen dir -- easy to make but lets be consistent / save some time.

- Architecture aware spin loops / barriers (Swapped the x86 pause assembly mnemonic for the ARM-compatible yield in synchronization primitives).

- Disabled the jevents library (Intel PMU exclusive) and implemented a "dummy" fallback in profile.hpp to allow the performance suite to compile.

- Updated tbb api calls to current oneTBB versions.

- explicitly scoped types in querybuilder.hpp to prevent naming conflicts with member functions.

# Original README below
...

# Database Engines: Vectorization vs. Compilation
This repository contains a collection of experiments, conducted to carve out the differences between two types of query processing engines: Vectorizing (interpretation based) engines and compiling engines.

## Where to Start
Have a look at src/benchmarks/tpch/queries/ to see how query processing for Typer and Tectorwise works. 

## How to Build
A configuration file is provided to build this project with CMake. 
In the project directory run:
```
mkdir -p build/release
cd build/release
cmake -DCMAKE_BUILD_TYPE=Release ../..
make
```

This creates among others the main binaries test\_all and run\_tpch.
Use test\_all to run unit tests and check whether your compilation worked.
Our main binary run\_tpch requires TPC-H tables as generated by the TPC-H dbgen tool. With these our experimental queries can be run on arbitrary scale factors.
